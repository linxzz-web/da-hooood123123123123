-- CONFIGURATION - EDIT THESE VALUES
local TARGET_USERNAME = "zdenda3030" -- The target player's username
local RISE_SPEED = 2 -- How fast to rise (studs per second)
local UNDER_OFFSET = 3 -- How many studs below the target to stay
local ITEM_NAME = "[WALLET]" -- The item name to check for
local CHECK_FREQUENCY = 1 -- How often to check inventory (seconds)

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

-- Variables
local isUnder = false
local targetPlayer = nil
local heartbeatConnection = nil

-- Wait for LocalPlayer
repeat task.wait() until LocalPlayer and LocalPlayer.Character

-- Function to find target player
local function findTargetPlayer()
    for _, player in ipairs(Players:GetPlayers()) do
        if player.Name:lower() == TARGET_USERNAME:lower() then
            return player
        end
    end
    return nil
end

-- Function to check if item exists in inventory
local function hasItem(itemName)
    -- Check Backpack
    local backpack = LocalPlayer:FindFirstChild("Backpack")
    if backpack then
        for _, item in ipairs(backpack:GetChildren()) do
            if item.Name == itemName then
                return true
            end
        end
    end
    
    -- Check Character for equipped items
    if LocalPlayer.Character then
        for _, item in ipairs(LocalPlayer.Character:GetChildren()) do
            if item.Name == itemName then
                return true
            end
        end
    end
    
    return false
end

-- Function to smoothly move player under target
local function moveUnderTarget()
    if not targetPlayer or not targetPlayer.Character then return end
    if not LocalPlayer.Character then return end
    
    local targetRoot = targetPlayer.Character:FindFirstChild("HumanoidRootPart") or targetPlayer.Character:FindFirstChild("Torso")
    local localRoot = LocalPlayer.Character:FindFirstChild("HumanoidRootPart") or LocalPlayer.Character:FindFirstChild("Torso")
    
    if not targetRoot or not localRoot then return end
    
    -- Calculate target position
    local targetPosition = Vector3.new(
        targetRoot.Position.X,
        targetRoot.Position.Y - UNDER_OFFSET,
        targetRoot.Position.Z
    )
    
    -- Smooth movement
    local currentPos = localRoot.Position
    local newY = currentPos.Y + (RISE_SPEED * 0.1)
    
    if newY >= targetPosition.Y then
        newY = targetPosition.Y
    end
    
    localRoot.CFrame = CFrame.new(currentPos.X, newY, currentPos.Z)
end

-- Function to start the effect
local function startUnder()
    if isUnder then return end
    
    targetPlayer = findTargetPlayer()
    if not targetPlayer then
        print("Target player '" .. TARGET_USERNAME .. "' not found!")
        return
    end
    
    print("Starting under effect - " .. ITEM_NAME .. " not found!")
    isUnder = true
    
    heartbeatConnection = RunService.Heartbeat:Connect(function()
        if isUnder and targetPlayer and targetPlayer.Character and LocalPlayer.Character then
            moveUnderTarget()
        end
    end)
end

-- Function to stop the effect
local function stopUnder()
    if isUnder then
        print("Stopping under effect - " .. ITEM_NAME .. " found!")
        isUnder = false
    end
    if heartbeatConnection then
        heartbeatConnection:Disconnect()
        heartbeatConnection = nil
    end
end

-- Main loop
spawn(function()
    print("=== UNDER SCRIPT LOADED ===")
    print("Target: " .. TARGET_USERNAME)
    print("Item to check: " .. ITEM_NAME)
    print("===========================")
    
    while true do
        local hasWallet = hasItem(ITEM_NAME)
        
        if hasWallet and isUnder then
            stopUnder()
        elseif not hasWallet and not isUnder then
            startUnder()
        end
        
        task.wait(CHECK_FREQUENCY)
    end
end)
