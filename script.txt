-- CONFIGURATION
local TARGET_USERNAME = "zdenda3030" -- The target player's username
local RISE_SPEED = 2 -- How fast to rise (studs per second)
local UNDER_OFFSET = 3 -- How many studs below the target to stay
local ITEM_NAME = "[WALLET]" -- The item to check for in TARGET's inventory

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")

-- Wait for local player
repeat task.wait() until LocalPlayer and LocalPlayer.Character
print("‚úÖ Local player loaded: " .. LocalPlayer.Name)

-- Find target player
local targetPlayer = nil
local function findTarget()
    for _, player in ipairs(Players:GetPlayers()) do
        if player.Name:lower() == TARGET_USERNAME:lower() then
            return player
        end
    end
    return nil
end

targetPlayer = findTarget()
if targetPlayer then
    print("‚úÖ Target found: " .. targetPlayer.Name)
else
    print("‚ùå Target NOT found: " .. TARGET_USERNAME .. " - waiting for them to join...")
end

-- Function to check if TARGET has the item
local function targetHasItem()
    if not targetPlayer then 
        targetPlayer = findTarget()
        if not targetPlayer then return false end
    end
    
    -- Check target's backpack
    local backpack = targetPlayer:FindFirstChild("Backpack")
    if backpack then
        for _, item in ipairs(backpack:GetChildren()) do
            if item.Name == ITEM_NAME then
                print("‚úÖ Target HAS " .. ITEM_NAME .. " in backpack!")
                return true
            end
        end
    end
    
    -- Check target's character for equipped items
    if targetPlayer.Character then
        for _, item in ipairs(targetPlayer.Character:GetChildren()) do
            if item:IsA("Tool") and item.Name == ITEM_NAME then
                print("‚úÖ Target HAS " .. ITEM_NAME .. " equipped!")
                return true
            end
        end
    end
    
    return false
end

-- Function to check target's inventory and print debug info
local function debugTargetInventory()
    if not targetPlayer then
        targetPlayer = findTarget()
        if not targetPlayer then
            print("‚ùå Target player not found!")
            return
        end
    end
    
    print("\n=== TARGET INVENTORY DEBUG ===")
    print("Target: " .. targetPlayer.Name)
    
    -- Check backpack
    local backpack = targetPlayer:FindFirstChild("Backpack")
    if backpack then
        print("Backpack items:")
        for _, item in ipairs(backpack:GetChildren()) do
            local hasStar = (item.Name == ITEM_NAME) and " ‚≠ê" or ""
            print("  - " .. item.Name .. hasStar)
        end
    else
        print("No Backpack found")
    end
    
    -- Check character
    if targetPlayer.Character then
        print("Equipped items:")
        for _, item in ipairs(targetPlayer.Character:GetChildren()) do
            if item:IsA("Tool") then
                local hasStar = (item.Name == ITEM_NAME) and " ‚≠ê" or ""
                print("  - " .. item.Name .. hasStar)
            end
        end
    end
    
    print("==============================\n")
end

-- Rising variables
local isRising = false
local riseConnection = nil

local function startRising()
    if isRising then return end
    if not targetPlayer or not targetPlayer.Character then
        print("‚ùå Target not available")
        return
    end
    
    print("üîº STARTING to rise under " .. targetPlayer.Name)
    isRising = true
    
    riseConnection = RunService.Heartbeat:Connect(function()
        if not isRising then return end
        if not targetPlayer or not targetPlayer.Character then return end
        if not LocalPlayer.Character then return end
        
        local targetRoot = targetPlayer.Character:FindFirstChild("HumanoidRootPart")
        local localRoot = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        
        if targetRoot and localRoot then
            -- Target position is UNDER the target
            local targetY = targetRoot.Position.Y - UNDER_OFFSET
            local currentY = localRoot.Position.Y
            
            -- Move up smoothly if below target
            if currentY < targetY then
                local newY = currentY + (RISE_SPEED * 0.1)
                if newY > targetY then newY = targetY end
                localRoot.CFrame = CFrame.new(localRoot.Position.X, newY, localRoot.Position.Z)
            end
        end
    end)
end

local function stopRising()
    if not isRising then return end
    print("üîΩ STOPPING rise")
    isRising = false
    if riseConnection then
        riseConnection:Disconnect()
        riseConnection = nil
    end
end

-- Monitor target's inventory
local lastState = nil
spawn(function()
    print("üîç Monitoring " .. TARGET_USERNAME .. "'s inventory for " .. ITEM_NAME)
    
    while true do
        if targetPlayer then
            local hasItem = targetHasItem()
            
            -- State changed
            if hasItem ~= lastState then
                if hasItem then
                    print("üéØ Target GOT the " .. ITEM_NAME .. " - STOPPING rise")
                    stopRising()
                else
                    print("üéØ Target LOST the " .. ITEM_NAME .. " - STARTING rise")
                    startRising()
                end
                lastState = hasItem
            end
            
            -- Print status every 5 seconds
            if tick() % 5 < 0.1 then
                local status = hasItem and "HAS üî¥" or "DOES NOT HAVE üü¢"
                print("üìä Target " .. status .. " " .. ITEM_NAME .. " | Rising: " .. (isRising and "YES üîº" or "NO üîΩ"))
            end
        else
            -- Try to find target again
            targetPlayer = findTarget()
            if targetPlayer then
                print("‚úÖ Target joined: " .. targetPlayer.Name)
            end
        end
        
        task.wait(1)
    end
end)

-- Watch for target joining
Players.PlayerAdded:Connect(function(player)
    if player.Name:lower() == TARGET_USERNAME:lower() then
        targetPlayer = player
        print("‚úÖ Target joined: " .. player.Name)
    end
end)

-- Controls
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.I then
        -- I = Debug target inventory
        debugTargetInventory()
        
    elseif input.KeyCode == Enum.KeyCode.R then
        -- R = Start rising
        startRising()
        
    elseif input.KeyCode == Enum.KeyCode.S then
        -- S = Stop rising
        stopRising()
        
    elseif input.KeyCode == Enum.KeyCode.T then
        -- T = Toggle
        if isRising then
            stopRising()
        else
            startRising()
        end
        
    elseif input.KeyCode == Enum.KeyCode.H then
        -- H = Help
        print("\n=== CONTROLS ===")
        print("I - Check target's inventory")
        print("R - Start rising")
        print("S - Stop rising")
        print("T - Toggle rise")
        print("H - This help")
        print("================\n")
    end
end)

print("\n‚úÖ SCRIPT LOADED - Monitoring " .. TARGET_USERNAME)
print("Logic: Rise when target DOES NOT have " .. ITEM_NAME)
print("       Stop when target HAS " .. ITEM_NAME)
print("Press H for controls\n")
